/*! @asymmetrik/angular2-leaflet-1.3.0 - Copyright Asymmetrik, Ltd. 2007-2017 - All Rights Reserved.*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("leaflet")):"function"==typeof define&&define.amd?define(["exports","@angular/core","leaflet"],t):t(e.angular2Leaflet=e.angular2Leaflet||{},e.ng.core,e.L)}(this,function(e,t,n){"use strict";var r=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},o=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};e.LeafletDirective=function(){function e(e){this.DEFAULT_ZOOM=1,this.DEFAULT_CENTER=n.latLng([38.907192,-77.036871]),this.DEFAULT_FPZ_OPTIONS={},this.fitBoundsOptions=this.DEFAULT_FPZ_OPTIONS,this.panOptions=this.DEFAULT_FPZ_OPTIONS,this.zoomOptions=this.DEFAULT_FPZ_OPTIONS,this.zoomPanOptions=this.DEFAULT_FPZ_OPTIONS,this.options={},this.mapReady=new t.EventEmitter,this.element=e}return e.prototype.ngOnInit=function(){this.map=n.map(this.element.nativeElement,this.options),null!=this.center&&null!=this.zoom&&this.setView(this.center,this.zoom),null!=this.fitBounds&&this.setFitBounds(this.fitBounds),this.doResize(),this.mapReady.emit(this.map)},e.prototype.ngOnChanges=function(e){e.zoom&&e.center&&null!=this.zoom&&null!=this.center?this.setView(e.center.currentValue,e.zoom.currentValue):e.zoom?this.setZoom(e.zoom.currentValue):e.center&&this.setCenter(e.center.currentValue),e.fitBounds&&this.setFitBounds(e.fitBounds.currentValue)},e.prototype.getMap=function(){return this.map},e.prototype.onResize=function(){this.delayResize()},e.prototype.doResize=function(){this.map.invalidateSize({})},e.prototype.delayResize=function(){null!=this.resizeTimer&&clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout(this.doResize.bind(this),200)},e.prototype.setView=function(e,t){this.map&&null!=e&&null!=t&&this.map.setView(e,t,this.zoomPanOptions)},e.prototype.setZoom=function(e){this.map&&null!=e&&this.map.setZoom(e,this.zoomOptions)},e.prototype.setCenter=function(e){this.map&&null!=e&&this.map.panTo(e,this.panOptions)},e.prototype.setFitBounds=function(e){this.map&&null!=e&&this.map.fitBounds(e,this.fitBoundsOptions)},e}(),r([t.Input("leafletFitBoundsOptions"),o("design:type",Object)],e.LeafletDirective.prototype,"fitBoundsOptions",void 0),r([t.Input("leafletPanOptions"),o("design:type",Object)],e.LeafletDirective.prototype,"panOptions",void 0),r([t.Input("leafletZoomOptions"),o("design:type",Object)],e.LeafletDirective.prototype,"zoomOptions",void 0),r([t.Input("leafletZoomPanOptions"),o("design:type",Object)],e.LeafletDirective.prototype,"zoomPanOptions",void 0),r([t.Input("leafletOptions"),o("design:type",Object)],e.LeafletDirective.prototype,"options",void 0),r([t.Output("leafletMapReady"),o("design:type",Object)],e.LeafletDirective.prototype,"mapReady",void 0),r([t.Input("leafletZoom"),o("design:type",Number)],e.LeafletDirective.prototype,"zoom",void 0),r([t.Input("leafletCenter"),o("design:type",n.LatLng)],e.LeafletDirective.prototype,"center",void 0),r([t.Input("leafletFitBounds"),o("design:type",n.LatLngBounds)],e.LeafletDirective.prototype,"fitBounds",void 0),r([t.HostListener("window:resize",["$event"]),o("design:type",Function),o("design:paramtypes",[]),o("design:returntype",void 0)],e.LeafletDirective.prototype,"onResize",null),e.LeafletDirective=r([t.Directive({selector:"[leaflet]"}),o("design:paramtypes",[t.ElementRef])],e.LeafletDirective);var i=function(){function e(e){this.leafletDirective=e}return e.prototype.init=function(){},e.prototype.getMap=function(){return this.leafletDirective.getMap()},e}(),a=function(){function e(e,t){this.remove=e,this.add=t}return e}(),s=function(){function e(){}return e.diffLayers=function(e,t){var n,r;return null==e&&(e=[]),null==t&&(t=[]),n=t.filter(function(t){return!e.find(function(e){return t===e})}),r=e.filter(function(e){return!t.find(function(t){return e===t})}),new a(n,r)},e}(),l=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},f=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},c=function(){function e(e){this.leafletDirective=new i(e)}return e.prototype.ngOnInit=function(){this.leafletDirective.init(),this.setLayers(this.layers,[])},e.prototype.ngOnChanges=function(e){if(e.layers){var t=e.layers.currentValue,n=e.layers.isFirstChange()?[]:e.layers.previousValue;this.setLayers(t,n)}},e.prototype.setLayers=function(e,t){var n=this.leafletDirective.getMap();if(null!=n){var r=s.diffLayers(e,t);r.remove.forEach(function(e){n.removeLayer(e)}),r.add.forEach(function(e){n.addLayer(e)})}},e}();l([t.Input("leafletLayers"),f("design:type",Array)],c.prototype,"layers",void 0),c=l([t.Directive({selector:"[leafletLayers]"}),f("design:paramtypes",[e.LeafletDirective])],c);var p=function(){function e(){}return e.mergeMaps=function(e,t){var n={};if(null!=e)for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);if(null!=t)for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);return n},e.mapSubtract=function(e,t){var n={};if(null!=e){for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);if(null!=t)for(var r in t)t.hasOwnProperty(r)&&delete n[r]}return n},e.mapToArray=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t},e}(),u=function(){function e(e,t){this.remove=e,this.add=t}return e}(),y=function(){function e(){}return e.prototype.getLayersControl=function(){return this.layersControl},e.prototype.init=function(e,t){var r=e.baseLayers||{},o=e.overlays||{};return this.layersControl=n.control.layers(r,o,t),this.layersControl},e.prototype.setLayersControlConfig=function(e,t){if(null==this.layersControl)return new u({},{});var n,r,o;n=p.mergeMaps(p.mapSubtract(t.baseLayers,e.baseLayers),p.mapSubtract(t.overlays,e.overlays)),r=p.mapSubtract(e.baseLayers,t.baseLayers),o=p.mapSubtract(e.overlays,t.overlays);for(var i in n)if(n.hasOwnProperty(i)){var a=n[i];this.layersControl.removeLayer(a)}for(var i in r)if(r.hasOwnProperty(i)){var a=r[i];this.layersControl.addBaseLayer(a,i)}for(var i in o)if(o.hasOwnProperty(i)){var a=o[i];this.layersControl.addOverlay(a,i)}return new u(n,p.mergeMaps(r,o))},e}(),h=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},d=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},v=function(){function e(e){this.leafletDirective=new i(e),this.controlLayers=new y}return e.prototype.ngOnInit=function(){this.leafletDirective.init(),this.controlLayers.init(this.layersControlConfig,this.layersControlOptions).addTo(this.leafletDirective.getMap())},e.prototype.ngOnChanges=function(e){e.layersControlCfg&&this.controlLayers.setLayersControlConfig(e.layersControlCfg.currentValue,e.layersControlCfg.previousValue)},e}();h([t.Input("leafletLayersControl"),d("design:type",Object)],v.prototype,"layersControlConfig",void 0),h([t.Input("leafletLayersControlOptions"),d("design:type",Object)],v.prototype,"layersControlOptions",void 0),v=h([t.Directive({selector:"[leafletLayersControl]"}),d("design:paramtypes",[e.LeafletDirective])],v);var m=function(){function e(e,t){this.baseLayers=e,this.overlays=t}return e}(),O=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},g=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},b=function(){function e(e){this.leafletDirective=new i(e),this.controlLayers=new y}return e.prototype.ngOnInit=function(){this.leafletDirective.init(),this.controlLayers.init({baseLayers:this.baseLayers},this.layersControlOptions).addTo(this.leafletDirective.getMap()),this.syncBaseLayer()},e.prototype.ngOnChanges=function(e){e.baseLayers&&this.setBaseLayers(e.baseLayers.currentValue,e.baseLayers.previousValue)},e.prototype.setBaseLayers=function(e,t){this.controlLayers.setLayersControlConfig(new m(e),new m(t)),this.syncBaseLayer()},e.prototype.syncBaseLayer=function(){var e,t=this.leafletDirective.getMap(),n=p.mapToArray(this.baseLayers);t.eachLayer(function(t){e=n.find(function(e){return t===e})}),null!=e?this.baseLayer=e:n.length>0&&(this.baseLayer=n[0],this.baseLayer.addTo(t))},e}();O([t.Input("leafletBaseLayers"),g("design:type",Object)],b.prototype,"baseLayers",void 0),O([t.Input("leafletLayersControlOptions"),g("design:type",Object)],b.prototype,"layersControlOptions",void 0),b=O([t.Directive({selector:"[leafletBaseLayers]"}),g("design:paramtypes",[e.LeafletDirective])],b);var D=function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a};e.LeafletModule=C=function(){function e(){}return e.forRoot=function(){return{ngModule:C,providers:[]}},e}(),e.LeafletModule=C=D([t.NgModule({exports:[e.LeafletDirective,c,v,b],declarations:[e.LeafletDirective,c,v,b]})],e.LeafletModule);var C,R=function(){function e(){}return e.prototype.diffLayers=function(e,t){var n,r;return n=p.mapSubtract(t,e),r=p.mapSubtract(e,t),new u(n,r)},e}(),w=function(){function e(e,t,n){this.type=e,this.url=t,this.options=n}return e.createTileLayer=function(e){var t;switch(e.type){case"xyz":t=L.tileLayer(e.url,e.options);break;case"wms":default:t=L.tileLayer.wms(e.url,e.options)}return t},e.createTileLayers=function(t){var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=e.createTileLayer(t[r]));return n},e.prototype.createTileLayer=function(){return e.createTileLayer(this)},e}();e.LeafletDirectiveWrapper=i,e.LeafletControlLayersUtil=R,e.LeafletLayersUtil=s,e.LeafletTileLayerDefinition=w,Object.defineProperty(e,"__esModule",{value:!0})});